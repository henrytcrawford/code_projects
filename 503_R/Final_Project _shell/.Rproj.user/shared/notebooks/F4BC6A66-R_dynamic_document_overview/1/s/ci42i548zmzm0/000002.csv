"0","# fit regression and extract b0 and b1"
"0","mod <- lm(ozone ~ solar_rad, data = aq)"
"0","b0 <- mod$coef[1]"
"0","b1 <- mod$coef[2]"
"0",""
"0","# create character versions of the coefficients for use in a figure legend or text"
"0","beta0 <-  round(b0, digits = 1) %>% as.character()"
"0","beta1 <-  round(b1, digits = 2) %>% as.character()"
"0",""
"0","# function to generate the plot to avoid repeating the code"
"0","plot_o3_solar <- function() {"
"0","  par(tcl = -0.2, mgp = c(2, 0.5, 0))"
"0","  plot(aq$solar_rad, aq$ozone,"
"0","    type = ""n"","
"0","    xlab = expression(""Solar radiation"" ~ ""(""*MJ*m^{-2}*"")""),"
"0","    ylab = ""Ozone concentration (ppb)"","
"0","    xlim = c(0, 15),"
"0","    ylim = c(0, 200)"
"0","  )"
"0","  grid()"
"0","  points(aq$solar_rad, aq$ozone, col = ""red"")"
"0","  xp <- c(min(aq$solar_rad, na.rm = TRUE), max(aq$solar_rad, na.rm = TRUE))"
"0","  yp <- b0 + b1*xp"
"0","  lines(xp, yp, col = ""black"")"
"0","}"
